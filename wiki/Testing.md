## Testing
Unit tests are written in C++ to test C++ functions and in Python to test the pipeline.

Unit tests can be triggered by `run_all_test.sh` in the build dir. This `run_all_test.sh` will make `ppptest` subfolder under the build folder if not yet generated by cmake build system, and copy/link necessary test data for all tests.

It has been tested on 
+ Ubuntu 18.04, 64bit, Python3
+ fedora 30 64bit, Python3

### Unit test written in C++

Unit tests (such as `ppGeomTests` in the `bin` folder) are written in C++, whey can only be run in the build directory, without installation

### Integration test in python

`PPP::Processor` derived class is not convenient to test in unit test, due to the inconvenient of generate test data in c++. Therefore, each processor class (corresponding to a software feature) can be tested in python, thanks to the python interface to this software. 

Python test script has no such restriction of running test in `build/ppptest`, since tested data are generated by python scripting. For example, test geometry is created during the test using FreeCAD scripting. Therefore, FreeCAD python3 must be installed.

Python test scripts are located under the `ppptest` subfolder (this is just the *python* subfolder in the source code tree, copied into build folder) of the build folder.
+ `test_imprint.py`
+ `test_collision.py`

Those python tests script implement `unittest` paradigm; python3-pytest will be used to auto-discovery python test methods

### Continuous integration

Gitlab runners ubuntu and fedora setup within UKAEA


### Coverage report in HTML

Only for Linux when using G++ compiler, also install tools like
see CI script for tools needed, `lcov htmldoc poppler-utils clang-tidy`
It is driven by setup in CMakeLists.txt of the project level.
`cmake  -DCODE_COVERAGE=ON -DPYTHON_EXECUTABLE:FILEPATH=$(which python3) ..`

after successful building, in the build folder, run `make coverage`
This will run the custom_target defined <cMake/ppp_coverage_target.cmake> which 
will run all unit tests by calling `../scripts/run_all_tests.sh`, then generate coverage report in html in the build folder.

